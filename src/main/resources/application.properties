spring.application.name=el-almacen-de-peliculas-online-ventas

# Flyway
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.validate-on-migrate=true
spring.flyway.baseline-on-migrate=true
spring.flyway.baseline-version=1
spring.sql.init.mode=never

# RabbitMQ
spring.rabbitmq.host=localhost
spring.rabbitmq.port=5672
spring.rabbitmq.username=guest
spring.rabbitmq.password=guest
spring.rabbitmq.publisher-confirm-type=correlated
spring.rabbitmq.publisher-returns=true
spring.rabbitmq.template.mandatory=true

rabbitmq.event.movie.queue.name=ventas.movie.queue
rabbitmq.event.movie.routing-key=Movie.#

rabbitmq.compras.events.exchange=peliculas.eventos.compras
rabbitmq.compras.compra.confirmada.routing-key=compra.confirmada.v1
rabbitmq.catalogo.events.exchange=catalogo.events
rabbitmq.ventas.stock.rechazado.queue=ventas.q.catalogo-stock-rechazado
rabbitmq.catalogo.stock.rechazado.routing-key=catalogo.stock.rechazado
rabbitmq.ventas.retry.exchange=ventas.retry.exchange
rabbitmq.ventas.dlx.exchange=ventas.dlx.exchange
rabbitmq.ventas.stock.rechazado.retry.queue=ventas.q.catalogo-stock-rechazado.retry
rabbitmq.ventas.stock.rechazado.retry.routing-key=ventas.stock.rechazado.retry
rabbitmq.ventas.stock.rechazado.retry.ttl-ms=10000
rabbitmq.ventas.stock.rechazado.dlq.queue=ventas.q.catalogo-stock-rechazado.dlq
rabbitmq.ventas.stock.rechazado.dlq.routing-key=ventas.stock.rechazado.dlq
rabbitmq.ventas.stock.rechazado.max-retries=3
rabbitmq.publisher.confirm-timeout-ms=5000
rabbitmq.publisher.strict-confirms=true

# Outbox
ventas.outbox.scheduler.enabled=true
ventas.outbox.scheduler.delay-ms=3000
ventas.outbox.max-attempts=10
ventas.outbox.retry.base-delay-ms=2000

# Projection bootstrap
ventas.catalogo.base-url=http://localhost:8081
ventas.catalogo.page-size=200
ventas.bootstrap.internal-token=local-bootstrap-token

# Security - OAuth2 JWT
spring.security.oauth2.resourceserver.jwt.issuer-uri=${OAUTH2_ISSUER_URI:http://localhost:9090/realms/videoclub}
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=${OAUTH2_JWK_SET_URI:http://localhost:9090/realms/videoclub/protocol/openid-connect/certs}

# Actuator
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when_authorized
management.health.db.enabled=true
management.health.rabbit.enabled=true

# Logging
logging.charset.console=UTF-8
logging.level.org.flywaydb=INFO
